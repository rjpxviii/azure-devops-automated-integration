flowchart TB
    subgraph "Azure DevOps"
        Git["Git Repository"]
        Build_Pipeline["Build Pipeline"]
        Release_Pipeline["Release Pipeline"]
        Artifacts["Artifacts"]
    end
    
    subgraph "Azure"
        subgraph "Shared Resources"
            KeyVault["Key Vault"]
            Monitor["Azure Monitor"]
            AppInsights["Application Insights"]
            LogAnalytics["Log Analytics"]
        end
        
        subgraph "Dev Environment"
            Dev_RG["Resource Group"]
            Dev_Plan["App Service Plan"]
            Dev_App["App Service"]
            Dev_Storage["Storage Account"]
        end
        
        subgraph "Staging Environment"
            Stage_RG["Resource Group"]
            Stage_Plan["App Service Plan"]
            Stage_App["App Service"]
            Stage_Storage["Storage Account"]
        end
        
        subgraph "Production Environment"
            Prod_RG["Resource Group"]
            Prod_Plan["App Service Plan"]
            Prod_App["App Service"]
            Prod_Storage["Storage Account"]
            CDN["Azure CDN"]
            FrontDoor["Azure Front Door"]
            WAF["Web Application Firewall"]
        end
    end
    
    subgraph "External"
        Developer["Developer"]
        User["End User"]
    end
    
    Developer -->|"Commit Code"| Git
    Git -->|"Trigger"| Build_Pipeline
    Build_Pipeline -->|"Create"| Artifacts
    Artifacts -->|"Source for"| Release_Pipeline
    
    Release_Pipeline -->|"Deploy to"| Dev_App
    Release_Pipeline -->|"Deploy to"| Stage_App
    Release_Pipeline -->|"Deploy to"| Prod_App
    
    Dev_App -.->|"Logs"| AppInsights
    Stage_App -.->|"Logs"| AppInsights
    Prod_App -.->|"Logs"| AppInsights
    
    AppInsights -->|"Analyze"| LogAnalytics
    LogAnalytics -->|"Alerts"| Monitor
    
    Dev_App -.->|"Static Content"| Dev_Storage
    Stage_App -.->|"Static Content"| Stage_Storage
    Prod_App -.->|"Static Content"| Prod_Storage
    
    Prod_Storage -->|"Origin for"| CDN
    CDN -->|"Protected by"| WAF
    WAF -->|"Routed through"| FrontDoor
    
    FrontDoor -->|"Serve Content"| User
    
    classDef devops fill:#FFEED9,stroke:#7D5A50,stroke-width:2px
    classDef shared fill:#D4F1F9,stroke:#05445E,stroke-width:2px
    classDef dev fill:#B5EAEA,stroke:#05445E,stroke-width:1px
    classDef stage fill:#FFBCBC,stroke:#7D5A50,stroke-width:1px
    classDef prod fill:#D8F8B7,stroke:#4C6793,stroke-width:1px
    classDef external fill:#F9F9F9,stroke:#333333,stroke-width:1px
    
    class Git,Build_Pipeline,Release_Pipeline,Artifacts devops
    class KeyVault,Monitor,AppInsights,LogAnalytics shared
    class Dev_RG,Dev_Plan,Dev_App,Dev_Storage dev
    class Stage_RG,Stage_Plan,Stage_App,Stage_Storage stage
    class Prod_RG,Prod_Plan,Prod_App,Prod_Storage,CDN,FrontDoor,WAF prod
    class Developer,User external